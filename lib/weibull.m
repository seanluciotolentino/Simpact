function varargout = weibull(fcn, varargin)
%WEIBULL
%   [http://en.wikipedia.org/wiki/Weibull_distribution]

% Copyright 2009-2010 by Hummeling Engineering (www.hummeling.com)

if nargin == 0
    weibull_test
    return
end

cmd = sprintf('%s_%s(varargin{:})', mfilename, fcn);
[varargout{1:nargout}] = eval(cmd);
end


%% test
function weibull_test

%debugMsg

%{
[kappa, lambda] = weibull('parameters', weibull('data'));

temperature = -25 : .1 : 25;
pdf = weibull('pdf', temperature + 273.15, kappa, lambda);

plot(temperature, pdf)
text(.25, .75, sprintf('\\kappa = %g\n\\lambda = %g K', kappa, lambda), ...
'Background', 'w', 'EdgeColor', 'k', 'Units', 'normalized')
title 'Weibull distribution of temperature in De Bilt [KNMI]'
xlabel 'temperature [\circC]'
grid on
%}

[kappa, lambda] = meshgrid(1 : .05 : 3, .2 : .2 : 10);
mu = lambda.*gamma(1 + 1./kappa);
var = lambda.^2.*gamma(1 + 2./kappa) - mu.^2;
sigma = sqrt(var);
clf
surfc(kappa, lambda, mu, 'EdgeAlpha', .1, 'FaceAlpha', .7)
xlabel \kappa
ylabel \lambda
zlabel '\mu, 2\sigma'

%surfc(kappa, lambda, var)
hold on
surfc(kappa, lambda, 2*sigma, 'EdgeAlpha', .1, 'FaceAlpha', .7)

kappa = 2.101349094688543;
lambda = [0 10];
mu = lambda*gamma(1 + 1/kappa);
plot3(kappa*[1 1], lambda, mu, 'r', 'LineWidth', 2)
end


%% parameters
function [kappa, lambda] = weibull_parameters(x)

x = log(x(:));

freq = ones(size(x));
options = struct('Display', 'off', 'TolX', 1e-6);

classX = class(x);

n = sum(freq);
rangex = max(x) - min(x);
maxx = max(x);

x0 = (x - maxx) ./ rangex;
sigmahat = (sqrt(6)*std(x0))/pi;
wgtmeanUnc = sum(freq.*x0) ./ n;

lower = sigmahat; upper = 2 * lower;
while weibull_parameters_lkeqn(upper, x0, freq, wgtmeanUnc) < 0
    lower = upper;
    upper = 2 * lower;
    if upper > realmax(classX) % overflow, no finite root
        error 'Unable to reach a maximum likelihood solution'
    end
end
bnds = [lower upper];
sigmahat = fzero(@weibull_parameters_lkeqn, bnds, options, x0, freq, wgtmeanUnc);
muhat = sigmahat .* log(sum(freq.*exp(x0./sigmahat)) ./ n );
kappa = 1./(rangex*sigmahat);
lambda = exp(rangex*muhat + maxx);


%% parameters_lkeqn
    function v = weibull_parameters_lkeqn(sigma, x, w, xbarWgtUnc)
        % Likelihood equation for the extreme value scale parameter.  Assumes that
        % sigma is strictly positive and finite, and x has been transformed to be
        % non-positive and have a reasonable range.  At least one uncensored x must
        % be strictly negative, or else the likelihood eqn will have a root at
        % sigma==0.  x should contain the transformed uncensored data and the
        % transformed censoring points of the censored data, and xbarWgtUnc should
        % be computed from the transformed uncensored data only.
        %
        % as sigma->0, v->(sigma+xbarWgtUnc-0)->xbarWgtUnc < 0 (because all x <= 0, and at least
        %                                                       one uncensored one is < 0)
        % as sigma->Inf, v ->(sigma+xbarWgtUnc-xbar)->Inf > 0
        %
        w = w .* exp(x ./ sigma);
        v = sigma + xbarWgtUnc - sum(x .* w) / sum(w);
    end
end


%% pdf
function pdf = weibull_pdf(x, kappa, lambda)
% Weibull probability density function [Wikipedia]

pdf = kappa/lambda*(x/lambda).^(kappa - 1) .* exp(-(x/lambda).^kappa);
end


%%
function weibull_

end


%% data
function [data, t] = weibull_data
% Monthly, seasonal, and annual means of the airtemperature in tenths
% of centigrade in De Bilt, Netherlands, 1706.
% (c) Copyright KNMI De Bilt, Netherlands, 2007.
% Component observational series:
% Delft/Rijnsburg (1706-1734), Zwanenburg (1735-1800 & 1811-1848),
% Haarlem (1801-1810) and Utrecht (1849-1897) reduced to De Bilt
% and De Bilt (1898-present)
% Sources for monthly mean airtemperatures:
% * "Het klimaat van Nederland gedurende de laatste twee en een halve eeuw",
%    A. Labrijn, M&V 49, KNMI, 1945. [1735-1900]
% * "Nicolaus Cruquius (1678-1754) and his meteorological observations"'
%    A. van Engelen & H. Geurts, publ. 165-IV, KNMI, 1985. [1706-1734]
% * "Het klimaat van het hoofdobservatorium De Bilt in de jaren 1901-1984",
%    Klimatologische Dienst, publ. 150-25, KNMI, 1985. [1901-1984]
% * "Maandoverzicht van het weer in Nederland",
%    Klimatologische Dienst, Vol. 82-100, KNMI. [1985-heden]
% Note:
% The seasonal and annual mean temperatures have been computed from
% the monthly means rounded to tenths of centigrades

%        Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec Year  Win Spr Sum Aut
allData = [
    1706   5  32  55  87 146 170 174 173 140 110  44  23   97  NaN  96 172  98
    1707   7  49  47  83 120 168 181 159 149  90  65  19   95   26  83 169 101
    1708  39  31  59  95 122 146 154 185 159  92  54   4   95   30  92 162 102
    1709 -51  -3  11  92 116 153 161 162 145 109  78  25   83  -17  73 159 111
    1710   4  18  56  70 133 150 152 161 147 108  70  55   94   16  86 154 108
    1711  32   6  50  98 127 168 160 154 142 106  60  34   95   31  92 161 103
    1712  -1  36  44  88 128 162 167 160 140 109  67  27   94   23  87 163 105
    1713  -9  56  43  64 116 134 150 166 149 106  52  28   88   25  74 150 102
    1714  13  44  53  90 108 144 185 161 130 110  63  27   94   28  84 163 101
    1715   2  42  61 107 121 145 156 148 141 118  79 -12   92   24  96 150 113
    1716 -57  22  39 102 118 141 164 168 134  96  52  15   83  -16  86 158  94
    1717  12  14  37  82 107 152 160 165 142 100  52  38   88   14  75 159  98
    1718 -14  -2  49  94 130 160 162 202 160 102  69  37   96    7  91 175 110
    1719   5  31  39  67 140 177 186 183 132  94  67   8   94   24  82 182  98
    1720  23  35  34  79 128 125 172 157 124  94  54  39   89   22  80 151  91
    1721  30   8  11 100 107 152 171 177 152  99  73  22   92   26  73 167 108
    1722   3  45  58  96 120 150 177 167 156 115  75  37  100   23  91 165 115
    1723  -3  32  67  94 129 155 154 171 148 123  84  50  100   22  97 160 118
    1724  42  42  41  78 123 166 169 181 151  97  39  21   96   45  81 172  96
    1725  17   9  37  82 102 112 147 135 126  93  66  23   79   16  74 131  95
    1726 -24   8  28  90 146 161 174 155 151 105  48   4   87    2  88 163 101
    1727  20  32  36  70 151 153 167 175 148 111  46  18   94   19  86 165 102
    1728  30  18  69  86 133 171 176 171 137  97  65   4   96   22  96 173 100
    1729 -24  13  19  71 112 163 174 173 164 113  66  48   91   -2  67 170 114
    1730  22  31  52  92 125 142 173 176 151  87  81  31   97   34  90 164 106
    1731  12   2  42  70 120 155 170 177 156 130  73  38   95   15  77 167 120
    1732   4  37  58  96 122 144 169 171 151 109  61   9   94   26  92 161 107
    1733  49  45  57 108 115 152 195 177 133  95  65  59  104   34  93 175  98
    1734  23  49  71 102 120 150 175 174 148  95  34  21   97   44  98 166  92
    1735  41  37  61  93 123 155 165 177 154  82  55  48   99   33  92 166  97
    1736  31  19  41  93 123 152 175 182 152 103  75  55  100   33  86 170 110
    1737  60  45  56  82 133 158 166 146 153  97  57  27   98   53  90 157 102
    1738   9  34  54  92 124 150 165 161 133 106  28  58   93   23  90 159  89
    1739  31  60  57  61 132 148 170 156 140  77   9  37   90   50  83 158  75
    1740 -45 -25  20  55  75 122 151 154 148  62  35  25   65  -11  50 142  82
    1741  10  35  32  59  98 139 170 164 142 116  79  26   89   23  63 158 112
    1742 -10  48  29  54  95 147 164 149 121  91  50 -24   76   21  59 153  87
    1743  18  44  43  49 118 159 157 171 143  73  79  25   90   13  70 162  98
    1744  -1  -4  35  72 112 148 158 153 137 107  64  31   84    7  73 153 103
    1745  12   3  36  77 123 143 159 154 146  98  50   1   84   15  79 152  98
    1746   0   3  17  67 140 143 172 153 138  76  21  41   81    1  75 156  78
    1747   5  53  16  80 117 163 163 166 150  96  76  48   94   33  71 164 107
    1748   7  -7  -7  56 119 169 172 174 146 105  77  71   90   16  56 172 109
    1749  44  27  31  76 137 123 170 172 145  97  50  49   93   47  81 155  97
    1750   6  58  80  82 125 150 183 163 155  86  35  24   96   38  96 165  92
    1751  24  -5  61  75 108 150 161 162 131  96  39  32   86   14  81 158  89
    1752  32  19  53  75 110 163 165 168 151 103  67  45   96   28  79 165 107
    1753 -12  25  61  83 120 166 167 156 150 109  45  36   92   19  88 163 101
    1754  18  12  16  65 129 145 154 167 140 109  57  24   86   22  70 155 102
    1755 -14 -14  29 102 106 175 167 152 132 101  55  43   86   -1  79 165  96
    1756  50  42  49  56 104 163 181 163 155  98  42  -5   92   45  70 169  98
    1757 -17  18  44  88 111 150 200 173 144  88  74  27   92   -1  81 174 102
    1758  -5  31  50  71 148 155 153 181 144 104  57  34   94   18  90 163 102
    1759  46  52  63  87 116 164 192 178 145 115  37  -4   99   44  89 178  99
    1760 -18  10  39  79 113 161 162 157 153  98  62  54   89   -4  77 160 104
    1761  25  43  67  82 128 155 156 177 147  73  53   1   92   41  92 163  91
    1762  29  20  22 105 128 152 168 146 139  70  32  -4   84   17  85 155  80
    1763 -58  29  33  73 103 148 163 165 132  83  56  40   81  -11  70 159  90
    1764  45  50  39  82 138 145 182 158 125  85  43   8   92   45  86 162  84
    1765  31  -8  66  96 119 160 153 173 138 110  45  11   91   10  94 162  98
    1766   0   9  47  97 121 148 166 168 145  99  55  12   89    7  88 161 100
    1767 -38  48  51  68  99 132 154 166 151 104  76   4   85    7  73 151 110
    1768 -21  30  37  74 116 151 172 166 123  90  58  30   86    4  76 163  90
    1769  18  20  48  88 114 137 171 161 145  74  56  39   89   23  83 156  92
    1770  21  30  23  63 114 140 164 177 159  97  50  46   90   30  67 160 102
    1771  -3   1   8  43 138 147 160 149 139 106  58  42   82   15  63 152 101
    1772   5  21  46  69 102 159 171 166 149 128  79  36   94   23  72 165 119
    1773  45  11  54  86 121 148 162 177 147 117  68  43   98   31  87 162 111
    1774  10  39  65  92 118 156 166 168 135 110  26  16   92   31  92 163  90
    1775  20  61  64  89 115 171 173 173 162 110  30  42  101   32  89 172 101
    1776 -52  34  62  94 106 158 184 168 139 111  55  22   90    8  87 170 102
    1777   0  -1  52  69 128 142 163 173 146 104  73  13   89    7  83 159 108
    1778  -7   5  40  92 138 164 195 182 132  81  71  64   96    4  90 180  95
    1779   5  57  70 102 137 149 184 194 168 126  60  35  107   42 103 176 118
    1780 -17  13  75  71 137 148 169 195 160 112  51   8   94   10  94 171 108
    1781 -11  35  56  96 128 185 185 189 158 108  56  16  100   11  93 186 107
    1782  38  -4  34  67 110 163 176 163 153  88  21  10   85   17  70 167  87
    1783  31  47  25  96 123 165 206 181 152 108  57 -13   98   29  81 184 106
    1784 -39 -17  16  54 140 155 167 159 158  70  61   1   77  -23  70 160  96
    1785   1  -9   0  61 114 148 171 162 161 105  56   0   81   -2  58 160 107
    1786   6  19   2  86 116 162 149 161 127  81   6  18   78    8  68 157  71
    1787  -1  35  64  69 110 153 161 163 135 109  45  35   90   17  81 159  96
    1788  29  15  27  84 131 167 183 162 150 103  43 -57   86   26  81 171  99
    1789 -32  32  -4  60 130 145 164 169 141  85  37  44   81  -19  62 159  88
    1790  29  51  60  56 134 145 150 154 124  89  29  33   88   41  83 150  81
    1791  36  36  57  98 109 138 156 168 137  92  41  15   90   35  88 154  90
    1792  15  15  42 102 109 142 170 173 127  85  50  34   89   15  84 162  87
    1793   8  40  42  63 104 132 180 161 126 112  49  41   88   27  70 158  96
    1794  -1  46  74 113 114 148 190 159 132  92  56  -5   93   29 100 166  93
    1795 -55   1  30  92 100 151 143 169 165 129  56  57   87  -20  74 154 117
    1796  60  42  29  93 116 148 160 170 154  90  46  -5   92   53  79 159  97
    1797  12  26  39  91 130 139 189 170 137  92  55  40   93   11  87 166  95
    1798  20  42  46  96 125 163 171 174 149 108  49 -23   93   34  89 169 102
    1799 -25  -5  19  53 103 131 153 156 137  91  59 -23   71  -18  58 147  96
    1800  -6  -2  17 106 147 127 155 170 153 100  65  15   87  -10  90 151 106
    1801  25  12  58  81 129 133 153 171 151 110  48  21   91   17  89 152 103
    1802  -9  21  44  86 111 144 141 175 141 106  45  27   86   11  80 153  97
    1803 -48 -16  35  97  96 134 181 166 119  89  43  19   76  -12  76 160  84
    1804  35  13  24  61 132 145 159 158 156  96  23 -27   81   22  72 154  92
    1805 -25   5  35  66  94 122 143 155 147  60  19  24   70  -16  65 140  75
    1806  28  33  36  54 141 139 157 165 146  90  73  65   94   28  77 154 103
    1807  20  29  13  70 129 145 182 188 117 109  39  26   89   38  71 172  88
    1808   7  14  12  52 145 142 189 181 141  80  40  -5   83   16  70 171  87
    1809 -21  51  48  53 140 141 157 162 137  83  39  34   85    8  80 153  86
    1810 -14   8  41  80  94 133 154 160 156  90  55  39   83    9  72 149 100
    1811 -26  34  64  98 159 171 175 165 139 130  77  40  102   16 107 170 115
    1812  19  41  31  53 127 144 153 161 138 106  28 -23   82   33  70 153  91
    1813  -2  46  48  84 135 149 168 157 136  84  45  11   88    7  89 158  88
    1814 -33 -26  10  99 100 129 175 160 137  82  52  29   76  -16  70 155  90
    1815 -25  39  74  91 132 151 149 159 139 101  42   3   88   14  99 153  94
    1816  15   6  36  80 106 124 153 145 131  99  29  21   79    8  74 141  86
    1817  38  55  48  57 108 163 159 152 154  60  77  18   91   38  71 158  97
    1818  33  21  51  81 118 173 181 160 141  96  64  12   94   24  83 171 100
    1819  33  39  54  94 136 158 176 183 153  90  39   0   96   28  95 172  94
    1820 -28   8  31  92 125 131 155 167 133  90  31   7   79   -7  83 151  85
    1821   0  10  43 104 109 128 147 166 154 103  76  53   91    6  85 147 111
    1822  42  51  74  88 144 173 172 166 134 109  79 -10  102   49 102 170 107
    1823 -70  15  47  69 130 129 158 170 141  92  65  47   83  -22  82 152  99
    1824  37  29  43  74 119 147 167 172 158 104  73  59   99   38  79 162 112
    1825  42  34  28  89 126 152 169 164 160 113  67  47   99   45  81 162 113
    1826 -24  39  57  85 118 171 196 194 149 124  56  52  101   21  87 187 110
    1827   0 -22  53  95 130 149 171 161 144 111  43  62   91   10  93 160  99
    1828  18  17  59  89 131 161 179 160 151 103  52  51   98   32  93 167 102
    1829 -33  -4  28  78 126 148 164 151 126  95  34 -45   72    5  77 154  85
    1830 -25 -24  52  93 126 134 177 154 128 104  67   5   83  -31  90 155 100
    1831  -4  27  61 104 124 151 181 176 144 140  62  48  101    9  96 169 115
    1832  -1  10  40  90 106 151 147 167 138 106  37  36   86   19  79 155  94
    1833 -18  43  26  75 153 164 164 143 133 101  60  65   92   20  85 157  98
    1834  61  31  60  73 141 163 192 181 156 109  50  45  105   52  91 179 105
    1835  24  48  52  74 111 164 175 169 143  90  36  21   92   39  79 169  90
    1836  17  30  70  80 124 143 168 158 127 103  57  44   93   23  91 156  96
    1837  22  38  25  55 102 156 164 175 135 116  54  37   90   35  61 165 102
    1838 -66 -18  41  63 124 149 170 158 132 108  38  21   77  -16  76 159  93
    1839  26  32  34  60 118 158 170 156 142 103  66  37   92   26  71 161 104
    1840  19  45  32 107 131 151 153 170 137  90  66 -24   90   34  90 158  98
    1841   2   0  64  94 154 146 147 166 161 106  65  50   96   -7 104 153 111
    1842 -19  22  61  74 135 161 157 197 142  90  38  41   92   18  90 172  90
    1843  29  10  46  69 122 133 160 175 147  96  62  58   92   27  79 156 102
    1844  25  14  41  99 129 150 151 149 148  98  54 -34   85   32  90 150 100
    1845   9 -28 -23  81  96 158 161 150 139 104  67  51   80  -18  51 156 103
    1846  45  59  68  90 126 176 185 194 168 112  49 -13  105   52  95 185 110
    1847 -16  12  39  61 137 140 176 174 119  96  74   9   85   -6  79 163  96
    1848 -43  41  62  95 144 161 164 154 133 106  60  28   92    2 100 160 100
    1849  13  53  46  78 144 158 164 155 139  94  45  10   92   31  89 159  93
    1850 -36  52  31  91 109 153 166 157 127  78  72  34   86    9  77 159  92
    1851  36  29  52  76 101 150 157 168 131 109  28  30   89   33  76 158  89
    1852  39  35  34  59 116 146 202 174 138  87  86  72   99   35  70 174 104
    1853  48 -11   0  64 117 154 170 155 132 105  35 -30   78   36  60 160  91
    1854  16  23  53  87 113 143 171 163 142  93  36  45   90    3  84 159  90
    1855  -7 -57  16  63 102 149 166 167 142 112  35  -6   74   -6  60 161  96
    1856  26  44  35  84 104 147 153 176 132 109  34  41   90   21  74 159  92
    1857   4  26  42  74 129 171 178 196 157 117  58  50  100   24  82 182 111
    1858   4  -5  31  76 111 188 158 174 159  99  11  31   86   16  73 173  90
    1859  32  51  71  75 130 174 200 178 136 110  42   2  100   38  92 184  96
    1860  32   7  32  64 123 144 150 144 127 100  29   7   80   14  73 146  85
    1861 -28  47  61  67 103 167 174 174 139 116  50  32   92    9  77 172 102
    1862  14  33  74 100 147 140 154 162 146 116  49  47   99   26 107 152 104
    1863  46  48  62  91 116 149 152 167 122 114  57  54   98   47  90 156  98
    1864 -15   8  53  75 111 143 158 144 136  93  37  -5   78   16  80 148  89
    1865  13  -5  11 111 152 142 177 159 168 107  69  28   94    1  91 159 115
    1866  53  48  40  95  98 176 156 148 141  97  65  45   97   43  78 160 101
    1867   6  65  26  87 124 150 147 175 147  95  57  12   91   39  79 157 100
    1868   5  53  59  82 159 169 198 185 156  94  47  65  106   23 100 184  99
    1869  17  64  27 107 113 129 175 155 151  92  54  17   92   49  82 153  99
    1870  23  -6  33  93 119 147 180 160 133  95  54 -15   85   11  82 162  94
    1871 -24  22  68  74 104 137 167 183 144  81  22   0   82   -6  82 162  82
    1872  32  50  67  83 114 159 192 165 144 100  74  50  103   27  88 172 106
    1873  44  12  59  79 100 162 186 172 129 102  60  39   95   35  79 173  97
    1874  41  26  57  98 100 150 186 156 152 108  40  -3   93   35  85 164 100
    1875  39  -2  33  79 131 161 169 180 152  81  43  18   90   11  81 170  92
    1876  -2  32  51  87  93 156 177 178 130 117  47  47   93   16  77 170  98
    1877  45  55  40  70  99 173 165 166 117  90  73  27   93   49  70 168  93
    1878  30  50  46 101 127 160 165 167 146 101  44   8   95   36  91 164  97
    1879 -15  15  37  65  95 152 146 162 139  97  36 -35   75    3  66 153  91
    1880   2  40  61  89 117 148 168 184 155  84  52  54   96    2  89 167  97
    1881 -27  21  45  67 123 144 183 153 134  65  77  29   85   16  78 160  92
    1882  24  40  75  86 126 140 161 151 136  99  55  26   93   31  96 151  97
    1883  23  49  10  84 126 158 159 162 137 101  61  35   92   33  73 160 100
    1884  55  49  61  75 127 133 182 190 159 102  44  38  101   46  88 168 102
    1885  -1  59  43  97 100 158 172 146 127  85  40  26   88   32  80 159  84
    1886   8 -11  32  83 126 140 166 168 160 111  70  20   89    8  80 158 114
    1887  -1  21  26  69 101 155 181 160 126  76  48  17   82   13  65 165  83
    1888   3 -10  21  65 113 157 145 150 135  83  58  36   80    3  66 151  92
    1889   7  13  33  78 160 188 158 155 127  90  51  -8   88   19  90 167  89
    1890  42   8  58  70 136 141 152 156 147  96  49 -48   84   14  88 150  97
    1891 -17  24  40  65 120 156 157 152 153 110  47  36   87  -14  75 155 103
    1892   7  25  22  77 133 143 154 171 140  87  63  13   86   23  77 156  97
    1893 -18  40  68 102 139 159 173 178 135 108  42  31   96   12 103 170  95
    1894  15  36  69 111 113 140 173 152 124  94  68  39   95   27  98 155  95
    1895  -6 -34  36  90 128 159 166 166 161  89  65  20   87    0  85 164 105
    1896  24  25  69  80 117 180 180 152 140  89  28  23   92   23  89 171  86
    1897  -9  34  66  79 117 171 170 179 132  94  47  29   92   16  87 173  91
    1898  45  37  34  83 112 147 148 184 153 104  60  58   97   37  76 160 106
    1899  42  34  37  78 108 156 181 177 141  85  91  -7   94   45  74 171 106
    1900  32  25  27  74 110 161 185 165 143 102  59  53   95   17  70 170 101
    1901  -3  -9  35  91 122 147 187 167 147 103  53  29   89   14  83 167 101
    1902  46  -4  52  85  94 158 155 148 131  86  37   8   83   24  77 154  85
    1903  29  56  71  56 128 143 156 153 144 111  57   8   93   31  85 151 104
    1904   7  30  37  97 121 144 180 160 124  92  55  40   91   15  85 161  90
    1905  13  36  60  66 119 169 180 160 129  65  38  23   88   30  82 170  77
    1906  36  24  40  76 125 143 170 169 134 118  79   2   93   28  80 161 110
    1907  17   7  47  76 126 137 139 152 137 113  58  31   87    9  83 143 103
    1908 -12  37  36  61 131 163 167 153 136  99  45  11   86   19  76 161  93
    1909   8   6  30  86 113 132 148 163 132 111  45  32   84    8  76 148  96
    1910  35  40  52  79 127 164 153 161 134 103  34  57   95   36  86 159  90
    1911  12  35  51  72 140 148 186 194 145  95  59  52   99   35  88 176 100
    1912  20  40  75  87 117 152 184 141 107  79  55  54   93   37  93 159  80
    1913  23  34  70  87 127 143 148 153 139 110  84  42   97   37  95 148 111
    1914  -1  56  60 101 116 143 179 174 137 100  51  50   97   32  92 165  96
    1915  32  31  41  75 124 157 156 156 131  76  29  52   88   38  80 156  79
    1916  60  27  44  88 131 122 153 164 133 103  59  26   93   46  88 146  98
    1917  -7 -15  19  46 147 183 167 162 146  81  73   0   84    1  71 171 100
    1918  28  40  46  83 139 135 162 159 131  93  43  58   93   23  89 152  89
    1919  19   3  41  63 138 144 139 160 144  70  18  37   81   27  81 148  77
    1920  42  54  73  93 129 158 162 141 132  82  32  21   93   44  98 154  82
    1921  62  31  67  88 134 148 181 169 140 127  13  32   99   38  96 166  93
    1922   4  17  42  61 134 152 151 149 126  65  49  46   83   18  79 151  80
    1923  40  30  65  78 103 116 189 158 130 107  29   4   87   39  82 154  89
    1924   1   4  33  66 133 149 163 144 140 106  50  38   86    3  77 152  99
    1925  38  48  36  81 138 152 184 163 118  98  28  14   92   41  85 166  81
    1926  22  63  58 100 107 139 178 165 154  80  67  29   97   33  88 161 100
    1927  39  28  66  78 114 132 171 169 141 104  41 -12   89   32  86 157  95
    1928  36  48  45  83 109 140 172 161 127  98  77  23   93   24  79 158 101
    1929 -14 -54  36  55 127 138 172 162 160 102  61  52   83  -15  73 157 108
    1930  47  16  48  89 117 178 162 166 140 103  73  22   97   38  85 169 105
    1931  26  12  24  73 136 153 166 158 116  89  67  33   88   20  78 159  91
    1932  40  15  31  73 122 150 175 189 148  93  55  35   94   29  75 171  99
    1933   1  28  68  84 121 155 181 174 148  99  39 -21   90   21  91 170  95
    1934  22  34  48 103 121 159 177 162 160 113  54  72  102   12  91 166 109
    1935  29  43  50  79 110 165 177 172 141  97  71  26   97   48  80 171 103
    1936  47  22  65  62 130 165 164 169 141  87  52  33   95   32  86 166  93
    1937  26  48  34  88 142 157 167 174 134 109  46  16   95   36  88 166  96
    1938  40  34  77  69 111 154 161 179 150  95  87   4   97   30  86 165 111
    1939  43  35  45  92 120 163 170 176 151  76  73  10   96   27  86 170 100
    1940 -55 -13  52  90 132 166 158 152 129  88  67   7   81  -19  91 159  95
    1941 -25  16  47  68  96 168 192 150 144  97  41  47   87   -1  70 170  94
    1942 -51 -42  27  93 121 144 160 179 147 119  56  42   83  -15  80 161 107
    1943  27  44  64 105 134 144 172 168 134 104  47  13   96   38 101 161  95
    1944  52  18  36  95 116 141 169 193 132  95  64  25   95   28  82 168  97
    1945 -16  60  73 102 136 160 178 164 145 115  49  32  100   23 104 167 103
    1946   2  46  42 103 129 139 174 157 145  93  65  -3   91   27  91 157 101
    1947 -14 -55  33  90 151 175 188 198 168  93  71  42   95  -24  91 187 111
    1948  51  30  67 100 127 153 166 164 144  97  49  35   99   41  98 161  97
    1949  37  38  40 104 113 144 174 171 172 114  52  44  100   37  86 163 113
    1950  10  55  65  77 128 173 173 171 134  92  59 -12   94   36  90 172  95
    1951  40  39  40  72 121 152 169 163 152  86  84  43   97   22  78 161 107
    1952  25  25  50 106 135 151 174 170 116  83  31  15   90   31  97 165  77
    1953  14  25  51  87 131 158 171 165 139 118  77  53   99   18  90 165 111
    1954   4  -3  60  68 132 151 143 158 135 120  69  55   91   18  87 151 108
    1955   3   3  20  87 102 145 178 179 145  98  68  48   90   20  70 167 104
    1956  22 -64  57  59 122 128 162 142 149  99  52  53   82    2  79 144 100
    1957  36  50  83  86 100 159 173 154 126 106  63  31   97   46  90 162  98
    1958  22  38  22  63 120 144 164 170 155 108  48  45   92   30  68 159 104
    1959  16   7  68  96 131 160 183 176 154 112  49  41   99   23  98 173 105
    1960  25  29  57  90 128 161 152 156 135 107  74  32   96   32  92 156 105
    1961  20  59  71 104 109 155 154 158 164 112  47  17   98   37  95 156 108
    1962  35  28  20  78  96 140 150 152 130 108  43  -7   81   27  65 147  94
    1963 -53 -34  42  89 110 157 164 154 140  97  85 -10   78  -31  80 158 107
    1964   7  35  26  86 141 151 165 157 138  76  61  22   89   11  84 158  92
    1965  25  20  43  76 118 147 148 150 125  97  27  44   85   22  79 148  83
    1966   4  41  51  83 129 168 156 158 138 112  43  44   94   30  88 161  98
    1967  30  51  67  74 127 144 181 165 142 119  51  34   99   42  89 163 104
    1968  22  14  60  91 108 152 162 170 144 118  52   0   91   23  86 161 105
    1969  46   2  25  81 131 155 185 181 153 130  67 -14   95   16  79 174 117
    1970   6  11  32  61 130 175 157 168 142 106  74  24   91    1  74 167 107
    1971  23  38  27  81 137 139 172 171 133 105  57  54   95   28  82 161  98
    1972   5  36  62  77 118 134 172 155 119  90  60  33   88   32  86 154  90
    1973  29  29  53  61 120 160 170 177 149  87  51  27   93   30  78 169  96
    1974  52  46  56  91 116 148 154 164 127  70  65  73   97   42  88 155  87
    1975  62  31  47  75 111 151 178 199 152  85  52  35   98   55  78 176  96
    1976  42  29  30  75 133 180 193 180 138 112  69  17  100   35  79 184 106
    1977  30  49  71  67 119 146 170 161 134 115  68  50   98   32  86 159 106
    1978  30  11  66  69 121 150 154 153 137 109  63  18   90   30  85 152 103
    1979 -32  -9  47  78 115 149 159 156 139 109  56  54   85   -8  80 155 101
    1980   2  48  47  80 123 150 158 170 153  94  49  36   93   35  83 159  99
    1981  27  15  81  83 133 144 163 167 147  85  67  -7   92   26  99 158 100
    1982  11  28  52  76 129 166 189 172 156 111  82  34  101   11  86 176 116
    1983  62   9  57  85 106 164 201 181 142 104  61  38  101   35  83 182 102
    1984  34  20  40  79 106 138 159 181 135 117  82  43   95   31  75 159 111
    1985 -31  -6  41  85 132 137 174 159 144 103  26  57   85    2  86 157  91
    1986  24 -36  42  62 133 164 172 156 116 114  79  51   90   15  79 164 103
    1987 -27  21  23 107 102 138 168 162 148 108  68  44   89   15  77 156 108
    1988  59  46  51  87 144 148 160 166 140 109  61  70  103   50  94 158 103
    1989  45  53  82  69 146 157 181 172 156 124  56  48  107   56  99 170 112
    1990  57  76  85  89 139 150 169 185 134 120  62  42  109   60 104 168 105
    1991  32  -8  88  85 100 127 190 180 150 102  53  39   95   22  91 166 102
    1992  27  49  69  87 156 172 183 178 146  80  80  37  105   38 104 178 102
    1993  51  24  58 111 143 159 161 152 131  90  22  51   96   37 104 157  81
    1994  52  15  73  82 124 150 214 176 136  94 102  53  106   39  93 180 111
    1995  38  67  55  92 128 147 201 197 142 127  68  -9  104   53  92 182 112
    1996  -1   6  32  94 107 157 163 173 125 108  59   6   86   -1  78 164  97
    1997 -12  62  80  78 128 160 174 205 143  97  67  50  103   19  95 180 102
    1998  47  64  76  94 149 158 163 165 150  99  37  46  104   54 106 162  95
    1999  52  31  73  98 142 150 191 175 174 106  67  48  109   43 104 172 116
    2000  43  59  68 100 147 160 155 174 158 113  78  51  109   50 105 163 116
    2001  26  45  49  83 141 152 185 185 134 142  71  29  104   41  91 174 116
    2002  44  71  72  93 134 165 176 186 146  95  79  29  108   48 100 176 107
    2003  25  18  73  99 132 178 188 193 139  75  80  40  103   24 101 186  98
    2004  36  48  59 104 123 155 167 188 152 113  63  32  103   41  95 170 109
    2005  53  24  65 104 126 168 177 162 157 133  69  40  107   36  98 169 120
    2006  15  29  39  90 145 167 223 164 179 136  92  65  112   28  91 185 136
    2007  71  60  80 131 141 175 170 171 138 101  69  38  112   65 117 172 103
    2008  65  51  59  89 157 165 181 174 136 101  69  24  106   51 102 173 102
    ];

data = allData(:, 2:13)/10;
data = data(:) + 273.15;        % [K]
[y, m] = meshgrid(allData(:, 1), 1:12);
t = datenum(y(:), m(:), 15*ones(numel(y), 1));
end